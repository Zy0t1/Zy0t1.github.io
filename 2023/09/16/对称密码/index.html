<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>对称密码&amp;Hash | Zy0t1's blog</title><meta name="author" content="Zy0t1"><meta name="copyright" content="Zy0t1"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="DES、IDEA、AES、SM4、TEA等分组密码，祖冲之、RC4等序列密码；SM3、MD5等hash函数">
<meta property="og:type" content="article">
<meta property="og:title" content="对称密码&amp;Hash">
<meta property="og:url" content="http://zy0t1.github.io/2023/09/16/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81/index.html">
<meta property="og:site_name" content="Zy0t1&#39;s blog">
<meta property="og:description" content="DES、IDEA、AES、SM4、TEA等分组密码，祖冲之、RC4等序列密码；SM3、MD5等hash函数">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2024/08/08/lJhAQOvR6n5GtjE.webp">
<meta property="article:published_time" content="2023-09-16T08:05:50.000Z">
<meta property="article:modified_time" content="2024-08-08T08:17:27.477Z">
<meta property="article:author" content="Zy0t1">
<meta property="article:tag" content="密码">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2024/08/08/lJhAQOvR6n5GtjE.webp"><link rel="shortcut icon" href="/img/web.png"><link rel="canonical" href="http://zy0t1.github.io/2023/09/16/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '对称密码&Hash',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-08 16:17:27'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/web.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('https://s2.loli.net/2024/08/08/lJhAQOvR6n5GtjE.webp')"><nav id="nav"><span id="blog-info"><a href="/" title="Zy0t1's blog"><span class="site-name">Zy0t1's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">对称密码&amp;Hash</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-16T08:05:50.000Z" title="发表于 2023-09-16 16:05:50">2023-09-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-08-08T08:17:27.477Z" title="更新于 2024-08-08 16:17:27">2024-08-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AF%86%E7%A0%81/">密码</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>36分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="对称密码&amp;Hash"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><span id="more"></span>
<h3 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h3><p>DES属于对称密码体制，前美国数据加密标准，也是一个分组加密算法。参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/songwenlong/p/5944139.html">DES算法详解 - songoo</a></p>
<p>传统DES以64位一组进行加密，密钥长度也是64位（实际使用56位，其中的8、16、24、32、40、48、56、64位作为奇校验位）</p>
<blockquote>
<p>奇校验：原始码+校验码=奇数个1；偶校验：原始码+校验码=偶数个1</p>
</blockquote>
<h4 id="明文初始化-IP置换"><a href="#明文初始化-IP置换" class="headerlink" title="明文初始化=IP置换"></a>明文初始化=IP置换</h4><p>将64位的明文按位重组，并将重组后的64位对半分为L0和R0两部分；下面是置换规则：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> IP[<span class="number">64</span>]=&#123;</span><br><span class="line"><span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="E扩展-E盒"><a href="#E扩展-E盒" class="headerlink" title="E扩展/E盒"></a>E扩展/E盒</h4><p>选取IP置换过后的明文右半部分R0，按照如下规则扩展为48位：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> E[<span class="number">48</span>]=&#123;</span><br><span class="line">    <span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,</span><br><span class="line">    <span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,</span><br><span class="line">    <span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,</span><br><span class="line">    <span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,</span><br><span class="line">    <span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,</span><br><span class="line">    <span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,</span><br><span class="line">    <span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,</span><br><span class="line">    <span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="密钥置换"><a href="#密钥置换" class="headerlink" title="密钥置换"></a>密钥置换</h4><p>将64位密钥（还是56位，去掉校验码）按照下面先进行<strong>置换</strong>：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> k1[<span class="number">56</span>]=&#123;</span><br><span class="line"><span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>之后分为两组</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> C[<span class="number">28</span>]=&#123;</span><br><span class="line"><span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> D[<span class="number">28</span>]=&#123;</span><br><span class="line"><span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再将每组都根据轮数将密钥进行<strong>向左循环移动1、2位</strong>，重复16轮：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> mv_left[<span class="number">16</span>]=&#123;</span><br><span class="line">    <span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>左移后合并，再从56位密钥中选出48位：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> k2[<span class="number">48</span>]=&#123;</span><br><span class="line"><span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">28</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,<span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">26</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>,<span class="number">2</span>,<span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">51</span>,<span class="number">45</span>,<span class="number">33</span>,<span class="number">48</span>,<span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,<span class="number">34</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="S盒代替"><a href="#S盒代替" class="headerlink" title="S盒代替"></a>S盒代替</h4><p>此时密钥和变换后的R0都变成了48位，需要先将两者进行XOR运算，之后得到48位的数据（这里就叫做F，灰常important），之后将F按照6位一组，共分8组，放入到S盒（4行*16列）中，然后按照如下规则选取每个S盒中的对应位置</p>
<blockquote>
<p>比如101101（假设是第三组），我们选取第一位和最后一位组成11=3，即第三行；中间四位0110=6，即第六列；就到S3中选取第三行，第6列的</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> S1[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>]=&#123;</span><br><span class="line">    &#123;</span><br><span class="line">    	&#123;<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>&#125;,&#123;<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>&#125;,&#123;<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>&#125;,&#123;<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>&#125;</span><br><span class="line">	&#125;,&#123;</span><br><span class="line">		&#123;<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>&#125;,				&#123;<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>&#125;,&#123;<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>&#125;,&#123;<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>&#125;</span><br><span class="line">	&#125;,&#123;</span><br><span class="line">    	&#123;<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>&#125;,&#123;<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>&#125;,&#123;<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>&#125;,&#123;<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>&#125;</span><br><span class="line">	&#125;,&#123;</span><br><span class="line">    	&#123;<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>&#125;,&#123;<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">19</span>&#125;,&#123;<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>&#125;,&#123;<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>&#125;</span><br><span class="line">	&#125;,&#123;</span><br><span class="line">    	&#123;<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>&#125;,&#123;<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>&#125;,&#123;<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>&#125;,&#123;<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>&#125;</span><br><span class="line">	&#125;,&#123;</span><br><span class="line">    	&#123;<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>&#125;,&#123;<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>&#125;,&#123;<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>&#125;,&#123;<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>&#125;</span><br><span class="line">	&#125;,&#123;</span><br><span class="line">    	&#123;<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>&#125;,&#123;<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>&#125;,&#123;<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>&#125;,&#123;<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>&#125;</span><br><span class="line">	&#125;,&#123;</span><br><span class="line">    	&#123;<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>&#125;,&#123;<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>&#125;,&#123;<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>&#125;,&#123;<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以发现S盒中没有大于16的，所以6位经由S盒出来后变为了4位，合并得到新的32位序列</p>
<h4 id="P盒扩展"><a href="#P盒扩展" class="headerlink" title="P盒扩展"></a>P盒扩展</h4><p>将上面得到的32位序列，按照P盒进行换位，得到A</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> P[<span class="number">32</span>]=&#123;</span><br><span class="line"><span class="number">16</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">28</span>,<span class="number">17</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">26</span>,<span class="number">5</span>,<span class="number">18</span>,<span class="number">31</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">24</span>,<span class="number">14</span>,<span class="number">32</span>,<span class="number">27</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">19</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">25</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时第一轮结束，之后R1=L0 XOR A；L1=R0；按照此规律一共进行16次运算</p>
<p>如果是最后一轮则进行IP逆置换</p>
<h4 id="IP末置换"><a href="#IP末置换" class="headerlink" title="IP末置换"></a>IP末置换</h4><p>此时左右部分相较于开始没有交换左右，但是内容发生改变，按照如下方式排序得到密文</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> IP_1[<span class="number">64</span>]=&#123;</span><br><span class="line"><span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,<span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,</span><br><span class="line"><span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,<span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,</span><br><span class="line"><span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,<span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,</span><br><span class="line"><span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,<span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><p>解密过程：将64位密文当作明文输入，第一次解密使用K16、第二次K15…以此类推，最后输出得到64位明文</p>
<p>3DES：包含两密钥和三密钥DES，均是使用三次DES。三密钥即在第三次使用K3主密钥进行解密，其他与两密钥大致无差别</p>
<p>两密钥DES：主密钥K1对明文加密—主密钥K2对密文进行DES逆运算—主密钥K1再次进行DES加密</p>
<p>解密：主密钥K1对密文DES逆运算—主密钥K2对密文进行运算—主密钥K1再次进行DES逆运算</p>
<hr>
<h3 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h3><p>对64位的明文块进行加密，密钥长达128位，相同算法可逆。参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40279192/article/details/107420773">国际数据加密算法（IDEA）简介</a></p>
<h4 id="密钥产生"><a href="#密钥产生" class="headerlink" title="密钥产生"></a>密钥产生</h4><p>密钥长128位；每一轮循环都需要6个子密钥，每个密钥16位，K1、K2…共八轮。每一轮密钥产生规则如下：</p>
<p>第一轮：按顺序取前16×6位，作为密钥</p>
<p>第二轮：前一轮用到了96位，因此先取后面的32（16×2）位作为密钥；之后再将密钥向左循环25位，再从前往后取64（16×4）位作为密钥</p>
<p>第n轮：优先取前一轮未用到的x位作为密钥，之后将整体循环左移25位，再从前向后取（128-x）位作为密钥</p>
<p>当第八轮的时候，正好使用33-128位，共96位作为密钥，此时还需要进行左移25位，用于最后一步输出变换</p>
<h4 id="单轮操作"><a href="#单轮操作" class="headerlink" title="单轮操作"></a>单轮操作</h4><p>本步骤需要循环8轮，明文是以64位进行的块加密，我们需要将64位明文分为4组，得到P1、P2、P3、P4；（在这里加乘结果都需要mod $2^{16} +1$ ，下面不在多提）</p>
<ol>
<li><p><strong>初始化</strong>：</p>
<ul>
<li>将P1与K1相乘得到结果A1，P4与K4同样操作得到A4；</li>
<li>将P2和K2，P3和K3分别相加得到A2和A3；</li>
</ul>
</li>
<li><p><strong>核心操作</strong>：</p>
<ol>
<li>A1与A3进行异或再乘K5：$A1\oplus A3\times K5$</li>
<li>A2与A4进行异或再加第一步：$A2\oplus A4+Step1$</li>
<li>第二步结果与K6相乘：$Step2\times K6=\alpha$</li>
<li>第一步与第三步结果相加：$Step1 + α=β$</li>
</ol>
</li>
<li><p><strong>最后处理</strong>：</p>
<ul>
<li>A1、A3与α进行xor得到B1、B3</li>
<li>A2、A4与第6步进行xor得到B2、B4</li>
</ul>
</li>
<li>进入下一轮</li>
</ol>
<h4 id="输出变换"><a href="#输出变换" class="headerlink" title="输出变换"></a>输出变换</h4><p>此时选取密钥的前64位，也就是选取4组，之后对轮换操作的i1、i2、i3、i4进行如下变换：</p>
<p>i1与K1相乘，i4与K4相乘，i2与K2相乘、i3与K3相乘；</p>
<p>最终拼接在一起得到密文</p>
<hr>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><p>高级加密标准，用来代替DES，AES=Rijndael算法子集。参考<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1i341187fK/?spm_id_from=333.337.search-card.all.click&amp;vd_source=a14ed599179f7f184401f3073d4efefa">【AES加密算法】</a></p>
<p>Rijndael算法规定明文和密钥均可变，只需要在[128,256]范围内的且是32的倍数即可；</p>
<p>下面是一些该算法的前置说明：</p>
<p>128bit=16Byte，将明文按照从上到下，从左到右对字节进行排序，得到所谓的状态；状态为4行，Nb列（Nb=数据bit总数/32，在128明文时就是4列）；</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span></span><br><span class="line"><span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span></span><br><span class="line"><span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span></span><br><span class="line"><span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span></span><br></pre></td></tr></table></figure>
<p>密钥也可按照上述方法排序，形成4行Nk列；而该算法的<strong>迭代轮数Nr</strong>由<strong>明文列数Nb</strong>和<strong>密钥列数Nk</strong>共同决定</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Nr</th>
<th>Nb=4</th>
<th>Nb=6</th>
<th>Nb=8</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nk=4</strong></td>
<td>10</td>
<td>12</td>
<td>14</td>
</tr>
<tr>
<td><strong>Nk=6</strong></td>
<td>12</td>
<td>12</td>
<td>14</td>
</tr>
<tr>
<td><strong>Nk=8</strong></td>
<td>14</td>
<td>14</td>
<td>14</td>
</tr>
</tbody>
</table>
</div>
<p>但是在AES中选定，明文长度分组固定为128位，密钥可选择128、192、256位；为方便说明，下面我们以AES-128为例，整体过程如下：</p>
<p>明文—初始变换—轮函数（9轮完整）—1轮最终轮—密文</p>
<p>轮函数包括：字节代换、行位移、列混合（最终轮没有）、轮密钥加</p>
<h4 id="初始变换"><a href="#初始变换" class="headerlink" title="初始变换"></a>初始变换</h4><p>密钥128位（也可以叫做轮密钥0）和明文128位，按照上述方式进行变换，之后相应位置进行异或操作即可，得到A</p>
<h4 id="字节代换ByteSub"><a href="#字节代换ByteSub" class="headerlink" title="字节代换ByteSub"></a>字节代换ByteSub</h4><p>即S盒变换，按照字节进行变换，有查表替换和计算两种方式，得到结果相同</p>
<p><strong>查表替换</strong>：每字节都由两个16进制数表示，拆开看寻找对应格子进行替换</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>x</th>
<th>00</th>
<th>01</th>
<th>02</th>
<th>03</th>
<th>04</th>
<th>05</th>
<th>06</th>
<th>07</th>
<th>08</th>
<th>09</th>
<th>0a</th>
<th>0b</th>
<th>0c</th>
<th>0d</th>
<th>0e</th>
<th>0f</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>00</strong></td>
<td>63</td>
<td>7c</td>
<td>77</td>
<td>7b</td>
<td>f2</td>
<td>6b</td>
<td>6f</td>
<td>c5</td>
<td>30</td>
<td>01</td>
<td>67</td>
<td>2b</td>
<td>fe</td>
<td>d7</td>
<td>ab</td>
<td>76</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>ca</td>
<td>82</td>
<td>c9</td>
<td>7d</td>
<td>fa</td>
<td>59</td>
<td>47</td>
<td>f0</td>
<td>ad</td>
<td>d4</td>
<td>a2</td>
<td>af</td>
<td>9c</td>
<td>a4</td>
<td>72</td>
<td>c0</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>b7</td>
<td>fd</td>
<td>93</td>
<td>26</td>
<td>36</td>
<td>3f</td>
<td>f7</td>
<td>cc</td>
<td>34</td>
<td>a5</td>
<td>e5</td>
<td>f1</td>
<td>71</td>
<td>d8</td>
<td>31</td>
<td>15</td>
</tr>
<tr>
<td><strong>30</strong></td>
<td>04</td>
<td>c7</td>
<td>23</td>
<td>c3</td>
<td>18</td>
<td>96</td>
<td>05</td>
<td>9a</td>
<td>07</td>
<td>12</td>
<td>80</td>
<td>e2</td>
<td>eb</td>
<td>27</td>
<td>b2</td>
<td>75</td>
</tr>
<tr>
<td><strong>40</strong></td>
<td>09</td>
<td>83</td>
<td>2c</td>
<td>1a</td>
<td>1b</td>
<td>6e</td>
<td>5a</td>
<td>a0</td>
<td>52</td>
<td>3b</td>
<td>d6</td>
<td>b3</td>
<td>29</td>
<td>e3</td>
<td>2f</td>
<td>84</td>
</tr>
<tr>
<td><strong>50</strong></td>
<td>53</td>
<td>d1</td>
<td>00</td>
<td>ed</td>
<td>20</td>
<td>fc</td>
<td>b1</td>
<td>5b</td>
<td>6a</td>
<td>cb</td>
<td>be</td>
<td>39</td>
<td>4a</td>
<td>4c</td>
<td>58</td>
<td>cf</td>
</tr>
<tr>
<td><strong>60</strong></td>
<td>d0</td>
<td>ef</td>
<td>aa</td>
<td>fb</td>
<td>43</td>
<td>4d</td>
<td>33</td>
<td>85</td>
<td>45</td>
<td>f9</td>
<td>02</td>
<td>7f</td>
<td>50</td>
<td>3c</td>
<td>9f</td>
<td>a8</td>
</tr>
<tr>
<td><strong>70</strong></td>
<td>51</td>
<td>a3</td>
<td>40</td>
<td>8f</td>
<td>92</td>
<td>9d</td>
<td>38</td>
<td>f5</td>
<td>bc</td>
<td>b6</td>
<td>da</td>
<td>21</td>
<td>10</td>
<td>ff</td>
<td>f3</td>
<td>d2</td>
</tr>
<tr>
<td><strong>80</strong></td>
<td>cd</td>
<td>0c</td>
<td>13</td>
<td>ec</td>
<td>5f</td>
<td>97</td>
<td>44</td>
<td>17</td>
<td>c4</td>
<td>a7</td>
<td>7e</td>
<td>3d</td>
<td>64</td>
<td>5d</td>
<td>19</td>
<td>73</td>
</tr>
<tr>
<td><strong>90</strong></td>
<td>60</td>
<td>81</td>
<td>4f</td>
<td>dc</td>
<td>22</td>
<td>2a</td>
<td>90</td>
<td>88</td>
<td>46</td>
<td>ee</td>
<td>b8</td>
<td>14</td>
<td>de</td>
<td>5e</td>
<td>0b</td>
<td>db</td>
</tr>
<tr>
<td><strong>a0</strong></td>
<td>e0</td>
<td>32</td>
<td>3a</td>
<td>0a</td>
<td>49</td>
<td>06</td>
<td>24</td>
<td>5c</td>
<td>c2</td>
<td>d3</td>
<td>ac</td>
<td>62</td>
<td>91</td>
<td>95</td>
<td>e4</td>
<td>79</td>
</tr>
<tr>
<td><strong>b0</strong></td>
<td>e7</td>
<td>c8</td>
<td>37</td>
<td>6d</td>
<td>8d</td>
<td>d5</td>
<td>4e</td>
<td>a9</td>
<td>6c</td>
<td>56</td>
<td>f4</td>
<td>ea</td>
<td>65</td>
<td>7a</td>
<td>ae</td>
<td>08</td>
</tr>
<tr>
<td><strong>c0</strong></td>
<td>ba</td>
<td>78</td>
<td>25</td>
<td>2e</td>
<td>1c</td>
<td>a6</td>
<td>b4</td>
<td>c6</td>
<td>e8</td>
<td>dd</td>
<td>74</td>
<td>1f</td>
<td>4b</td>
<td>bd</td>
<td>8b</td>
<td>8a</td>
</tr>
<tr>
<td><strong>d0</strong></td>
<td>70</td>
<td>3e</td>
<td>b5</td>
<td>66</td>
<td>48</td>
<td>03</td>
<td>f6</td>
<td>0e</td>
<td>61</td>
<td>35</td>
<td>57</td>
<td>b9</td>
<td>86</td>
<td>c1</td>
<td>1d</td>
<td>9e</td>
</tr>
<tr>
<td><strong>e0</strong></td>
<td>e1</td>
<td>f8</td>
<td>98</td>
<td>11</td>
<td>69</td>
<td>d9</td>
<td>8e</td>
<td>94</td>
<td>9b</td>
<td>1e</td>
<td>87</td>
<td>e9</td>
<td>ce</td>
<td>55</td>
<td>28</td>
<td>df</td>
</tr>
<tr>
<td><strong>f0</strong></td>
<td>8c</td>
<td>a1</td>
<td>89</td>
<td>0d</td>
<td>bf</td>
<td>e6</td>
<td>42</td>
<td>68</td>
<td>41</td>
<td>99</td>
<td>2d</td>
<td>0f</td>
<td>b0</td>
<td>54</td>
<td>bb</td>
<td>16</td>
</tr>
</tbody>
</table>
</div>
<p><strong>计算</strong>：首先将A中每一个字节取mod 256的乘法逆，之后再对每个字节按位与下面矩阵相乘，之后再与下面矩阵进行异或</p>
<p>$\begin{pmatrix}  1  &amp;0  &amp;0  &amp;0  &amp;1 &amp;1 &amp;1 &amp;1 \\ 1  &amp;1  &amp;0  &amp;0  &amp;0  &amp;1  &amp;1 &amp;1\\  1  &amp;1  &amp;1  &amp;0  &amp;0  &amp;0  &amp;1  &amp;1\\  1  &amp;1  &amp;1  &amp;1  &amp;0  &amp;0  &amp;0  &amp;1\\  1  &amp;1  &amp;1  &amp;1  &amp;1  &amp;0  &amp;0  &amp;0\\  0  &amp;1  &amp;1  &amp;1  &amp;1  &amp;1  &amp;0  &amp;0\\  0  &amp;0  &amp;1  &amp;1  &amp;1  &amp;1  &amp;1  &amp;0\\  0  &amp;0  &amp;0  &amp;1  &amp;1  &amp;1  &amp;1  &amp;1\end{pmatrix} * \begin{pmatrix}x0\\ x1\\ x2\\ x3\\ x4\\ x5\\ x6\\ x7 \end{pmatrix}\oplus \begin{pmatrix} 1\\ 1\\ 0\\ 0\\ 0\\ 1\\ 1\\ 0 \end{pmatrix}$</p>
<h4 id="行移位ShiftRows"><a href="#行移位ShiftRows" class="headerlink" title="行移位ShiftRows"></a>行移位ShiftRows</h4><p>灰常简单，按照状态行，进行左移；0行不动，1行左移C1字节，2行左移C2字节，3行左移C3字节</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Nb</th>
<th>C1</th>
<th>C2</th>
<th>C3</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>6</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>8</td>
<td>1</td>
<td>3</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<p>对于AES-128来说就是：0行不动，1行左移1字节，2行左移2字节，3行左移3字节</p>
<h4 id="列混合MixColumn"><a href="#列混合MixColumn" class="headerlink" title="列混合MixColumn"></a>列混合MixColumn</h4><p>将输入矩阵左乘以如下矩阵，即A · State（注意需要保证在GF(256)上）</p>
<p>$A=\begin{bmatrix}<br>  02  &amp; 03  &amp; 01  &amp; 01  \\ 01  &amp; 02  &amp; 03  &amp; 01  \\ 01  &amp; 01  &amp; 02  &amp; 03  \\ 03  &amp; 01  &amp; 01  &amp; 02 \end{bmatrix}$</p>
<p>或者将状态每一列（从上到下）看作：$a\mathop{x}\nolimits^{3} + b\mathop{x}\nolimits^{2}+cx+d$ 并与$03\mathop{x}\nolimits^{3}+01\mathop{x}\nolimits^{2}+01x+02$ 相乘并mod ($\mathop{x}\nolimits^{4}+1$)，注意其中的项数均为16进制</p>
<h4 id="轮密钥加AddRoundKey"><a href="#轮密钥加AddRoundKey" class="headerlink" title="轮密钥加AddRoundKey"></a>轮密钥加AddRoundKey</h4><p>也灰常简单，将前面得到的4×4的矩阵与轮密钥1、2等进行相应字节的异或即可</p>
<h4 id="轮密钥生成"><a href="#轮密钥生成" class="headerlink" title="轮密钥生成"></a>轮密钥生成</h4><p>轮密钥生成算法会根据密钥列数Nk而略有不同，Nk&lt;=6（即正好以192位为分界）与Nk&gt;6略有不同。<br>当密钥矩阵为4×4（轮密钥0）时，而且我们需要进行10轮扩展，也就是需要到达轮密钥10，即11×(4×4)，共44列，从左到右标记为$W_0$、$W_1$、$W_2$…$W_i$</p>
<p>Nk&lt;=6 （以128为例）：<br>当i不是4的倍数时：$W[i]=W[i-4]\oplus W[i-1]$ ；否则：$W[i]=W[i-4]\oplus T(W[i-1])$</p>
<p><strong>函数T</strong>：</p>
<ol>
<li>字循环：一列4字节，向上循环1字节</li>
<li>字节代换：对上述循环结果使用S盒进行字节代换</li>
<li><p>轮常量异或：前两步结果与Rcon[ j ]进行三者异或，j表示轮数</p>
<blockquote>
<p>$Rcon[j]=\begin{bmatrix}2^{i}\\ 00\\ 00\\ 00 \end{bmatrix}$，注意需要使用16进制</p>
</blockquote>
</li>
</ol>
<p>Nk&gt;6时：以256为例，此时Nk=8，当i是8的倍数时与上述过程类似，还是进行T函数运算；不是8的倍数，但是4的倍数时，需要进行$ByteSub(W[i-1])$，其余无差别</p>
<hr>
<h3 id="TEA系列"><a href="#TEA系列" class="headerlink" title="TEA系列"></a>TEA系列</h3><p>微型加密算法，属于分组加密；使用64位的明文（拆分为x，y）和128位的密钥（Key[4]），建议的迭代轮数为32位，关键标志delta=<strong>0x9E3779B9</strong>，</p>
<p>每一轮具体加密过程如下，重复32轮，结束之后拼接x、y得到密文：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sum += delta;</span><br><span class="line">x += ((y &lt;&lt; <span class="number">4</span>) + Key[<span class="number">0</span>]) ^ (y + sum) ^ ((y &gt;&gt; <span class="number">5</span>) + Key[<span class="number">1</span>]);</span><br><span class="line">y += ((x &lt;&lt; <span class="number">4</span>) + Key[<span class="number">2</span>]) ^ (x + sum) ^ ((x &gt;&gt; <span class="number">5</span>) + Key[<span class="number">3</span>]);</span><br></pre></td></tr></table></figure>
<p>解密过程如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sum = delta &lt;&lt; <span class="number">5</span>;   <span class="comment">//注意这里,sum = 32轮之后的黄金分割值. 因为我们要反序解密.</span></span><br><span class="line"><span class="comment">//总共加密32轮 那么反序也解密32轮</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">   <span class="comment">// 先将y解开 然后参与运算在解x</span></span><br><span class="line">   y -= ((x &lt;&lt; <span class="number">4</span>) + Key[<span class="number">2</span>]) ^ (x + sum) ^ ((x &gt;&gt; <span class="number">5</span>) + Key[<span class="number">3</span>]);</span><br><span class="line">   x -= ((y &lt;&lt; <span class="number">4</span>) + Key[<span class="number">0</span>]) ^ (y + sum) ^ ((y &gt;&gt; <span class="number">5</span>) + Key[<span class="number">1</span>]);</span><br><span class="line">   sum -= delta;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>之后该算法被发现有缺陷，于是乎有了其升级版，XTEA和XXTEA</p>
<p><strong>XTEA</strong>：明文与密钥长度不变，建议轮数仍是32轮，异或运算改变</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)&#123;</span><br><span class="line">	x += (((y &lt;&lt; <span class="number">4</span>) ^ (y &gt;&gt; <span class="number">5</span>)) + y) ^ (sum + Key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">	sum += delta;</span><br><span class="line">	y += (((x &lt;&lt; <span class="number">4</span>) ^ (x &gt;&gt; <span class="number">5</span>)) + x) ^ (sum + Key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>XXTEA</strong>：明文可以是32bit的倍数，没有固定长度v[]，轮数也会依据明文长度n改变(6+52/n轮)；具体流程与上述两者区别较大；下面是每一轮的具体过程（PS：y的初始值为v[n - 1]）：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sum += DELTA;  </span><br><span class="line">e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;  </span><br><span class="line"><span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; n - <span class="number">1</span>; p++)&#123;  </span><br><span class="line">    x = v[p + <span class="number">1</span>];</span><br><span class="line">    v[p] += (((y&gt;&gt;<span class="number">5</span>^x&lt;&lt;<span class="number">2</span>) + (x&gt;&gt;<span class="number">3</span>^y&lt;&lt;<span class="number">4</span>)) ^ ((sum^x) + (Key[(p&amp;<span class="number">3</span>)^e] ^ y)));</span><br><span class="line">    y = v[p];  </span><br><span class="line">&#125;  </span><br><span class="line">x = v[<span class="number">0</span>]; </span><br><span class="line">v[n<span class="number">-1</span>] += (((y&gt;&gt;<span class="number">5</span>^x&lt;&lt;<span class="number">2</span>) + (x&gt;&gt;<span class="number">3</span>^y&lt;&lt;<span class="number">4</span>)) ^ ((sum^x) + (Key[(p&amp;<span class="number">3</span>)^e] ^ y)));  </span><br><span class="line">y = v[n<span class="number">-1</span>];  </span><br></pre></td></tr></table></figure>
<hr>
<h3 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h3><p>也叫SMS4分组算法，数据分组128bit，密钥也是128bit，加密算法与密钥扩展算法都采用32轮迭代。是对合运算（加密解密算法相同，只是轮密钥使用顺序相反），以1字节和1字（这里32bit）。参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/kentle/p/14135865.html">SM4加密算法原理和简单实现 - kentle</a></p>
<p>大致过程如下所示：</p>
<p>明文输入四个字$(X_{0},X_{1},X_{2},X_{3})$，轮密钥$rk_{i}$，其中$i$代表轮数</p>
<p>经过32次迭代，得到$(X_{32},X_{33},X_{34},X_{35})$，之后在进行反序，并拼接得到密文</p>
<h4 id="迭代运算"><a href="#迭代运算" class="headerlink" title="迭代运算"></a>迭代运算</h4><p>$X_{i+4}=F(X_{i},X_{i+1},X_{i+2},X_{i+3},rk_{i})=X_{i}\oplus T(X_{i+1}\oplus X_{i+2}\oplus X_{i+3}\oplus rk_{i})$</p>
<h4 id="合成置换T"><a href="#合成置换T" class="headerlink" title="合成置换T"></a>合成置换T</h4><p>由非线性变换$\tau$和线性变换$L$组成，即$T(X_{1}\oplus X_{2}\oplus X_{3}\oplus rk_{i})=L(\tau (X_{1}\oplus X_{2}\oplus X_{3}\oplus rk_{i}))$</p>
<p><strong>非线性变换</strong>：</p>
<p>简单来说就是S盒，将$X_{1}\oplus X_{2}\oplus X_{3}\oplus rk_{i}$结果作为输入，同样的到一个字，即四字节，查找下面S盒进行替换，记得到结果B</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>xx</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>a</th>
<th>b</th>
<th>c</th>
<th>d</th>
<th>e</th>
<th>f</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>D6</td>
<td>90</td>
<td>E9</td>
<td>FE</td>
<td>CC</td>
<td>E1</td>
<td>3D</td>
<td>B7</td>
<td>16</td>
<td>B6</td>
<td>14</td>
<td>C2</td>
<td>28</td>
<td>FB</td>
<td>2C</td>
<td>05</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>2B</td>
<td>67</td>
<td>9A</td>
<td>76</td>
<td>2A</td>
<td>BE</td>
<td>04</td>
<td>C3</td>
<td>AA</td>
<td>44</td>
<td>13</td>
<td>26</td>
<td>49</td>
<td>86</td>
<td>06</td>
<td>99</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>9C</td>
<td>42</td>
<td>50</td>
<td>F4</td>
<td>91</td>
<td>EF</td>
<td>98</td>
<td>7A</td>
<td>33</td>
<td>54</td>
<td>0B</td>
<td>43</td>
<td>ED</td>
<td>CF</td>
<td>AC</td>
<td>62</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>E4</td>
<td>B3</td>
<td>1C</td>
<td>A9</td>
<td>C9</td>
<td>08</td>
<td>E8</td>
<td>95</td>
<td>80</td>
<td>DF</td>
<td>94</td>
<td>FA</td>
<td>75</td>
<td>8F</td>
<td>3F</td>
<td>A6</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>47</td>
<td>07</td>
<td>A7</td>
<td>FC</td>
<td>F3</td>
<td>73</td>
<td>17</td>
<td>BA</td>
<td>83</td>
<td>59</td>
<td>3C</td>
<td>19</td>
<td>E6</td>
<td>85</td>
<td>4F</td>
<td>A8</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>68</td>
<td>6B</td>
<td>81</td>
<td>B2</td>
<td>71</td>
<td>64</td>
<td>DA</td>
<td>8B</td>
<td>F8</td>
<td>EB</td>
<td>0F</td>
<td>4B</td>
<td>70</td>
<td>56</td>
<td>9D</td>
<td>35</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>1E</td>
<td>24</td>
<td>0E</td>
<td>5E</td>
<td>63</td>
<td>58</td>
<td>D1</td>
<td>A2</td>
<td>25</td>
<td>22</td>
<td>7C</td>
<td>3B</td>
<td>01</td>
<td>21</td>
<td>78</td>
<td>87</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>D4</td>
<td>00</td>
<td>46</td>
<td>57</td>
<td>9F</td>
<td>D3</td>
<td>27</td>
<td>52</td>
<td>4C</td>
<td>36</td>
<td>02</td>
<td>E7</td>
<td>A0</td>
<td>C4</td>
<td>C8</td>
<td>9E</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>EA</td>
<td>BF</td>
<td>8A</td>
<td>D2</td>
<td>40</td>
<td>C7</td>
<td>38</td>
<td>B5</td>
<td>A3</td>
<td>F7</td>
<td>F2</td>
<td>CE</td>
<td>F9</td>
<td>61</td>
<td>15</td>
<td>A1</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>E0</td>
<td>AE</td>
<td>5D</td>
<td>A4</td>
<td>9B</td>
<td>34</td>
<td>1A</td>
<td>55</td>
<td>AD</td>
<td>93</td>
<td>32</td>
<td>30</td>
<td>F5</td>
<td>8C</td>
<td>B1</td>
<td>E3</td>
</tr>
<tr>
<td><strong>a</strong></td>
<td>1D</td>
<td>F6</td>
<td>E2</td>
<td>2E</td>
<td>82</td>
<td>66</td>
<td>CA</td>
<td>60</td>
<td>C0</td>
<td>29</td>
<td>23</td>
<td>AB</td>
<td>0D</td>
<td>53</td>
<td>4E</td>
<td>6F</td>
</tr>
<tr>
<td><strong>b</strong></td>
<td>D5</td>
<td>DB</td>
<td>37</td>
<td>45</td>
<td>DE</td>
<td>FD</td>
<td>8E</td>
<td>2F</td>
<td>03</td>
<td>FF</td>
<td>6A</td>
<td>72</td>
<td>6D</td>
<td>6C</td>
<td>5B</td>
<td>51</td>
</tr>
<tr>
<td><strong>c</strong></td>
<td>8D</td>
<td>1B</td>
<td>AF</td>
<td>92</td>
<td>BB</td>
<td>DD</td>
<td>BC</td>
<td>7F</td>
<td>11</td>
<td>D9</td>
<td>5C</td>
<td>41</td>
<td>1F</td>
<td>10</td>
<td>5A</td>
<td>D8</td>
</tr>
<tr>
<td><strong>d</strong></td>
<td>0A</td>
<td>C1</td>
<td>31</td>
<td>88</td>
<td>A5</td>
<td>CD</td>
<td>7B</td>
<td>BD</td>
<td>2D</td>
<td>74</td>
<td>D0</td>
<td>12</td>
<td>B8</td>
<td>E5</td>
<td>B4</td>
<td>B0</td>
</tr>
<tr>
<td><strong>e</strong></td>
<td>89</td>
<td>69</td>
<td>97</td>
<td>4A</td>
<td>0C</td>
<td>96</td>
<td>77</td>
<td>7E</td>
<td>65</td>
<td>B9</td>
<td>F1</td>
<td>09</td>
<td>C5</td>
<td>6E</td>
<td>C6</td>
<td>84</td>
</tr>
<tr>
<td><strong>f</strong></td>
<td>18</td>
<td>F0</td>
<td>7D</td>
<td>EC</td>
<td>3A</td>
<td>DC</td>
<td>4D</td>
<td>20</td>
<td>79</td>
<td>EE</td>
<td>5F</td>
<td>3E</td>
<td>D7</td>
<td>CB</td>
<td>39</td>
<td>48</td>
</tr>
</tbody>
</table>
</div>
<p><strong>线性变换</strong>：对B分别进行左移2、10、18、24位，之后五者再进行异或</p>
<p>$L(B)=B\oplus (B&lt;&lt;&lt;2)\oplus (B&lt;&lt;&lt;10)\oplus (B&lt;&lt;&lt;18)\oplus (B&lt;&lt;&lt;24)$</p>
<h4 id="密钥扩展"><a href="#密钥扩展" class="headerlink" title="密钥扩展"></a>密钥扩展</h4><p>大致过程如下：</p>
<p>将输入的128位密钥换为$(MK_{0},MK_{1},MK_{2},MK_{3})$，再对其进行扩展，即将每项分别异或$(FK_{0}=A3B1BAC6,FK_{1}=56AA3350,FK_{2}=677D9191,FK_{3}=B27022DC)$</p>
<p>将其结果记为$(K_{0},K_{1},K_{2},K_{3})$，之后可以得到轮密钥，计算过程如下（$CK$为常数）</p>
<p>$rk_{i}=K_{i+4}=K_{i}\oplus T’(K_{i+1}\oplus K_{i+2}\oplus K_{i+3}\oplus CK_{i})$</p>
<p><strong>$T’$函数</strong>：与前面的函数基本类似，但是线性变换不一样，改为如下方式<br>$L’(B)=B\oplus (B&lt;&lt;&lt;13)\oplus (B&lt;&lt;&lt;23)$</p>
<p><strong>CK常数</strong>：$ck_{i,j}$是$CK_{i}$的第$j$个字节，即$CK_{i}=(ck_{i,0},ck_{i,1},ck_{i,2},ck_{i,3})$，且$ck_{i,j}=(4i+j)\times 7(\bmod 256)$，具体值如下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> CK[<span class="number">32</span>]=&#123;</span><br><span class="line">	<span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>,</span><br><span class="line">    <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>, <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>,</span><br><span class="line">    <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>,</span><br><span class="line">    <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>,</span><br><span class="line">    <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>, <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>,</span><br><span class="line">    <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>,</span><br><span class="line">    <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>,</span><br><span class="line">    <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>, <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="补充-1"><a href="#补充-1" class="headerlink" title="补充"></a>补充</h4><p>解密过程如下：输入密文$(X_{35},X_{34},X_{33},X_{32})$，倒序输入轮密钥，最后需要反转一下在合并</p>
<p>$X_{i}=X_{i+4}\oplus T(X_{i+3}\oplus X_{i+2}\oplus X_{i+1}\oplus rk_{i})$</p>
<hr>
<h3 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h3><p>属于流/序列密码，密钥长度可变（可以给任意位），面向字节操作，依赖于足够大的数据表对表进行非线性变换，来产生非线性的密钥序列</p>
<p>加密过程主要包括初始化S表与生成密钥流</p>
<h4 id="初始化S表"><a href="#初始化S表" class="headerlink" title="初始化S表"></a>初始化S表</h4><ol>
<li><p>对S表进行线性填充，即$S_{0}=0,S_{1}=1…$，一般为256字节</p>
</li>
<li><p>再用种子密钥循环填充另一个256字节的R表</p>
</li>
<li><p>利用R表的内容，对S表进行重新排序，规律如下：</p>
<p>$j=(j+S[i]+R[i])\bmod 256$，之后交换S[j]和S[i]的位置即可</p>
</li>
</ol>
<h4 id="密钥流生成"><a href="#密钥流生成" class="headerlink" title="密钥流生成"></a>密钥流生成</h4><p>生成一个与明文长度一样的密钥，用来对每一位进行异或。过程如下：</p>
<p>循环明文长度r（byte）次：$i=(i+1)\bmod 256; j=(j+S[i])\bmod 256$，之后将S[i]和S[j]进行交换，再相加并$\bmod 256$得到t，$K[r]=S[t]$，得到的K数组即密钥流</p>
<hr>
<h3 id="祖冲之ZUC"><a href="#祖冲之ZUC" class="headerlink" title="祖冲之ZUC"></a>祖冲之ZUC</h3><p>这里祖冲之算法得到的并非是我们常说的密文，得到的是流密码中的密钥，之后还需要与处理过的明文进行异或。参考<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1xG4y1v7pK/?spm_id_from=333.337.search-card.all.click&amp;vd_source=a14ed599179f7f184401f3073d4efefa">【以ZUC算法为例介绍学习方法】| 祖冲之序列密码算法| 序列密码| 加密算法| 密码学| |国密| 学习方法_哔哩哔哩_bilibili</a></p>
<p>主要由线性反馈移位寄存器(LFSR)、比特重组(BR)、非线性函数F三大部分组成</p>
<h4 id="LFSR"><a href="#LFSR" class="headerlink" title="LFSR"></a>LFSR</h4><p>包括16个31bit的寄存器单元记为$S_{i}$，有初始化模式和工作模式两种，前者需要31bit的输入u后者不用</p>
<p><strong>初始化模式</strong>：</p>
<ol>
<li><p>$v=2^{15}S_{15}+2^{17}S_{13}+2^{21}S_{10}+2^{20}S_{4}+(2^{8}+1)S_{0}\bmod(2^{31}-1)$</p>
</li>
<li><p>$S_{16}=(v+u)\bmod(2^{31}-1)$</p>
</li>
<li><p>if $S_{16}=0$ then $S_{16}=2^{31}-1$</p>
</li>
<li><p>$(S_{1},S_{2}…S_{16})$变为$(S_{0}…S_{15})$</p>
</li>
</ol>
<p><strong>工作模式</strong>：相比于初始化模式，只需要去掉第二步即可</p>
<h4 id="BR"><a href="#BR" class="headerlink" title="BR"></a>BR</h4><p>输入LSFR的16个寄存器，并按照以下规则抽取128bit来组成4个32bit字</p>
<p>$X_{0}=S_{15H}||S_{14L}——;<br>X_{1}=S_{11L}||S_{9H}——;<br>X_{2}=S_{7L}||S_{5H}——;<br>X_{3}=S_{2L}||S_{0H}$</p>
<h4 id="F函数"><a href="#F函数" class="headerlink" title="F函数"></a>F函数</h4><p>以前面X0、X1、X2作为输入的函数，会输出一个32bit的字W，将W与X3异或的到输出密钥序列。过程如下：（S函数即S盒，有两个；L函数）</p>
<ol>
<li>$W=[(X_{0}\oplus R_{1})+R_{2}]\bmod 2^{32}$</li>
<li>$W_{1}=(R_{1}+X_{1})\bmod 2^{32}$</li>
<li>$W_{2}=R_{2}\oplus X_{2}$</li>
<li>$R_{1}=S[L_{1}(W_{1L}||W_{2H})]$</li>
<li>$R_{2}=S[L_{2}(W_{1H}||W_{2L})]$</li>
</ol>
<p><strong>L线性变换函数</strong>：</p>
<ul>
<li>$L_{1}=X\oplus (X&lt;&lt;&lt;2)\oplus (X&lt;&lt;&lt;10)\oplus (X&lt;&lt;&lt;18)\oplus (X&lt;&lt;&lt;24)$</li>
<li>$L_{2}=X\oplus (X&lt;&lt;&lt;8)\oplus (X&lt;&lt;&lt;14)\oplus (X&lt;&lt;&lt;22)\oplus (X&lt;&lt;&lt;30)$</li>
</ul>
<p><strong>S盒</strong>：包括四个8×8的盒子$(S_{0},S_{1},S_{0},S_{1})$，将输入S盒的32位进行8bit分组，每组分别进入到上述盒子中进行置换，高四位做行，第四位做列；</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>S0</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>a</th>
<th>b</th>
<th>c</th>
<th>d</th>
<th>e</th>
<th>f</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>3E</td>
<td>72</td>
<td>5B</td>
<td>47</td>
<td>CA</td>
<td>E0</td>
<td>00</td>
<td>33</td>
<td>04</td>
<td>D1</td>
<td>54</td>
<td>98</td>
<td>09</td>
<td>B9</td>
<td>6D</td>
<td>CB</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>7B</td>
<td>1B</td>
<td>F9</td>
<td>32</td>
<td>AF</td>
<td>9D</td>
<td>6A</td>
<td>A5</td>
<td>B8</td>
<td>2D</td>
<td>FC</td>
<td>1D</td>
<td>08</td>
<td>53</td>
<td>03</td>
<td>90</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>4D</td>
<td>4E</td>
<td>84</td>
<td>99</td>
<td>E4</td>
<td>CE</td>
<td>D9</td>
<td>91</td>
<td>DD</td>
<td>B6</td>
<td>85</td>
<td>48</td>
<td>8B</td>
<td>29</td>
<td>6E</td>
<td>AC</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>CD</td>
<td>F8</td>
<td>1E</td>
<td>73</td>
<td>43</td>
<td>69</td>
<td>C6</td>
<td>B5</td>
<td>BD</td>
<td>FD</td>
<td>39</td>
<td>63</td>
<td>20</td>
<td>D4</td>
<td>38</td>
<td></td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>76</td>
<td>7D</td>
<td>B2</td>
<td>A7</td>
<td>CH</td>
<td>ED</td>
<td>57</td>
<td>C5</td>
<td>F3</td>
<td>BB</td>
<td>14</td>
<td>21</td>
<td>06</td>
<td>55</td>
<td>9B</td>
<td></td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>E3</td>
<td>EF</td>
<td>5E</td>
<td>31</td>
<td>4F</td>
<td>7F</td>
<td>5A</td>
<td>A4</td>
<td>OD</td>
<td>82</td>
<td>51</td>
<td>49</td>
<td>5F</td>
<td>BA</td>
<td>58</td>
<td>1C</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>4A</td>
<td>16</td>
<td>D5</td>
<td>17</td>
<td>A8</td>
<td>92</td>
<td>24</td>
<td>1F</td>
<td>8C</td>
<td>D8</td>
<td>AE</td>
<td>2E</td>
<td>01</td>
<td>D3</td>
<td>AD</td>
<td></td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>3B</td>
<td>4B</td>
<td>DA</td>
<td>46</td>
<td>EB</td>
<td>C9</td>
<td>DE</td>
<td>9A</td>
<td>8F</td>
<td>87</td>
<td>D7</td>
<td>3A</td>
<td>80</td>
<td>6F</td>
<td>2F</td>
<td>C8</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>B1</td>
<td>B4</td>
<td>37</td>
<td>F7</td>
<td>22</td>
<td>13</td>
<td>28</td>
<td>7C</td>
<td>CC</td>
<td>3C</td>
<td>89</td>
<td>C7</td>
<td>C3</td>
<td>96</td>
<td>56</td>
<td></td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>07</td>
<td>BF</td>
<td>7E</td>
<td>F0</td>
<td>0B</td>
<td>2B</td>
<td>97</td>
<td>52</td>
<td>35</td>
<td>41</td>
<td>79</td>
<td>61</td>
<td>A6</td>
<td>4C</td>
<td>10</td>
<td>FE</td>
</tr>
<tr>
<td><strong>a</strong></td>
<td>BC</td>
<td>26</td>
<td>95</td>
<td>88</td>
<td>8A</td>
<td>B0</td>
<td>A3</td>
<td>FB</td>
<td>C0</td>
<td>18</td>
<td>94</td>
<td>F2</td>
<td>E1</td>
<td>E5</td>
<td>E9</td>
<td>5D</td>
</tr>
<tr>
<td><strong>b</strong></td>
<td>D0</td>
<td>DC</td>
<td>11</td>
<td>66</td>
<td>64</td>
<td>50</td>
<td>EC</td>
<td>59</td>
<td>42</td>
<td>75</td>
<td>12</td>
<td>F5</td>
<td>74</td>
<td>9C</td>
<td>AA</td>
<td>23</td>
</tr>
<tr>
<td><strong>c</strong></td>
<td>0E</td>
<td>86</td>
<td>AB</td>
<td>BE</td>
<td>2A</td>
<td>02</td>
<td>E7</td>
<td>67</td>
<td>E6</td>
<td>44</td>
<td>A2</td>
<td>6C</td>
<td>C2</td>
<td>93</td>
<td>9F</td>
<td>F1</td>
</tr>
<tr>
<td><strong>d</strong></td>
<td>F6</td>
<td>FA</td>
<td>36</td>
<td>D2</td>
<td>50</td>
<td>68</td>
<td>9E</td>
<td>62</td>
<td>71</td>
<td>15</td>
<td>3D</td>
<td>D6</td>
<td>40</td>
<td>C4</td>
<td>E2</td>
<td>0F</td>
</tr>
<tr>
<td><strong>e</strong></td>
<td>8E</td>
<td>83</td>
<td>77</td>
<td>6B</td>
<td>25</td>
<td>05</td>
<td>3F</td>
<td>30</td>
<td>EA</td>
<td>70</td>
<td>B7</td>
<td>A1</td>
<td>E8</td>
<td>A9</td>
<td>65</td>
<td></td>
</tr>
<tr>
<td><strong>f</strong></td>
<td>8D</td>
<td>27</td>
<td>1A</td>
<td>DB</td>
<td>81</td>
<td>B3</td>
<td>A0</td>
<td>F4</td>
<td>45</td>
<td>7A</td>
<td>19</td>
<td>DF</td>
<td>EE</td>
<td>78</td>
<td>34</td>
<td>60</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>S1</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>a</th>
<th>b</th>
<th>c</th>
<th>d</th>
<th>e</th>
<th>f</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>55</td>
<td>C2</td>
<td>63</td>
<td>71</td>
<td>3B</td>
<td>C8</td>
<td>47</td>
<td>86</td>
<td>9F</td>
<td>3C</td>
<td>DA</td>
<td>5B</td>
<td>29</td>
<td>AA</td>
<td>FD</td>
<td>77</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>8C</td>
<td>C5</td>
<td>94</td>
<td>0C</td>
<td>A6</td>
<td>1A</td>
<td>13</td>
<td>00</td>
<td>E3</td>
<td>A8</td>
<td>16</td>
<td>72</td>
<td>40</td>
<td>F9</td>
<td>F8</td>
<td>42</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>44</td>
<td>26</td>
<td>68</td>
<td>96</td>
<td>81</td>
<td>D9</td>
<td>45</td>
<td>3E</td>
<td>10</td>
<td>76</td>
<td>C6</td>
<td>A7</td>
<td>8B</td>
<td>39</td>
<td>43</td>
<td>E1</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>3A</td>
<td>B5</td>
<td>56</td>
<td>2A</td>
<td>C0</td>
<td>6D</td>
<td>B3</td>
<td>05</td>
<td>22</td>
<td>66</td>
<td>BF</td>
<td>DC</td>
<td>0B</td>
<td>FA</td>
<td>62</td>
<td>48</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>DD</td>
<td>20</td>
<td>11</td>
<td>06</td>
<td>36</td>
<td>C9</td>
<td>C1</td>
<td>CF</td>
<td>F6</td>
<td>27</td>
<td>52</td>
<td>BB</td>
<td>69</td>
<td>F5</td>
<td>D4</td>
<td>87</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>7F</td>
<td>84</td>
<td>4C</td>
<td>D2</td>
<td>9C</td>
<td>57</td>
<td>A4</td>
<td>BC</td>
<td>4F</td>
<td>9A</td>
<td>DF</td>
<td>FE</td>
<td>D6</td>
<td>8D</td>
<td>7A</td>
<td>EB</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>2B</td>
<td>53</td>
<td>D8</td>
<td>5C</td>
<td>A1</td>
<td>14</td>
<td>17</td>
<td>FB</td>
<td>23</td>
<td>D5</td>
<td>7D</td>
<td>30</td>
<td>67</td>
<td>73</td>
<td>08</td>
<td>09</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>EE</td>
<td>B7</td>
<td>70</td>
<td>3F</td>
<td>61</td>
<td>B2</td>
<td>19</td>
<td>8E</td>
<td>4E</td>
<td>E5</td>
<td>4B</td>
<td>93</td>
<td>8F</td>
<td>5D</td>
<td>DB</td>
<td>A9</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>AD</td>
<td>F1</td>
<td>AE</td>
<td>2E</td>
<td>CB</td>
<td>0D</td>
<td>FC</td>
<td>F4</td>
<td>2D</td>
<td>46</td>
<td>6E</td>
<td>1D</td>
<td>97</td>
<td>E8</td>
<td>D1</td>
<td>E9</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>4D</td>
<td>37</td>
<td>A5</td>
<td>75</td>
<td>5E</td>
<td>83</td>
<td>9E</td>
<td>AB</td>
<td>82</td>
<td>9D</td>
<td>B9</td>
<td>1C</td>
<td>E0</td>
<td>CD</td>
<td>49</td>
<td>89</td>
</tr>
<tr>
<td><strong>a</strong></td>
<td>01</td>
<td>B6</td>
<td>BD</td>
<td>58</td>
<td>24</td>
<td>A2</td>
<td>5F</td>
<td>38</td>
<td>78</td>
<td>99</td>
<td>15</td>
<td>90</td>
<td>50</td>
<td>B8</td>
<td>95</td>
<td>E4</td>
</tr>
<tr>
<td><strong>b</strong></td>
<td>D0</td>
<td>91</td>
<td>C7</td>
<td>CE</td>
<td>ED</td>
<td>0F</td>
<td>B4</td>
<td>6F</td>
<td>A0</td>
<td>CC</td>
<td>F0</td>
<td>02</td>
<td>4A</td>
<td>79</td>
<td>C3</td>
<td>DE</td>
</tr>
<tr>
<td><strong>c</strong></td>
<td>A3</td>
<td>EF</td>
<td>EA</td>
<td>51</td>
<td>E6</td>
<td>6B</td>
<td>18</td>
<td>EC</td>
<td>1B</td>
<td>2C</td>
<td>80</td>
<td>F7</td>
<td>74</td>
<td>E7</td>
<td>FF</td>
<td>21</td>
</tr>
<tr>
<td><strong>d</strong></td>
<td>5A</td>
<td>6A</td>
<td>54</td>
<td>1E</td>
<td>41</td>
<td>31</td>
<td>92</td>
<td>35</td>
<td>C4</td>
<td>33</td>
<td>07</td>
<td>0A</td>
<td>BA</td>
<td>7E</td>
<td>0E</td>
<td>34</td>
</tr>
<tr>
<td><strong>e</strong></td>
<td>88</td>
<td>B1</td>
<td>98</td>
<td>7C</td>
<td>F3</td>
<td>3D</td>
<td>60</td>
<td>6C</td>
<td>7B</td>
<td>CA</td>
<td>D3</td>
<td>1F</td>
<td>32</td>
<td>65</td>
<td>04</td>
<td>28</td>
</tr>
<tr>
<td><strong>f</strong></td>
<td>64</td>
<td>BE</td>
<td>85</td>
<td>9B</td>
<td>2F</td>
<td>59</td>
<td>8A</td>
<td>D7</td>
<td>B0</td>
<td>25</td>
<td>AC</td>
<td>AF</td>
<td>12</td>
<td>03</td>
<td>E2</td>
<td>F2</td>
</tr>
</tbody>
</table>
</div>
<h4 id="密钥装入"><a href="#密钥装入" class="headerlink" title="密钥装入"></a>密钥装入</h4><p>用来给S0-S15进行赋值，$S_{i}=k_{i}拼d_{i}拼iv_{i}$；8+8+15=31bit</p>
<p>KEY为128bit的初始密码，分成16组；IV为128bit的初始化向量，同理</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">d0=<span class="number">100010011010111</span></span><br><span class="line">d1=<span class="number">010011010111100</span></span><br><span class="line">d2=<span class="number">110001001101011</span></span><br><span class="line">d3=<span class="number">001001101011110</span></span><br><span class="line">d4=<span class="number">101011110001001</span></span><br><span class="line">d5=<span class="number">011010111100010</span></span><br><span class="line">d6=<span class="number">111000100110101</span></span><br><span class="line">d7=<span class="number">000100110101111</span></span><br><span class="line">d8=<span class="number">100110101111000</span></span><br><span class="line">d9=<span class="number">010111100010011</span></span><br><span class="line">d10=<span class="number">110101111000100</span></span><br><span class="line">d11=<span class="number">001101011110001</span></span><br><span class="line">d12=<span class="number">101111000100110</span></span><br><span class="line">d13=<span class="number">01111001001101</span></span><br><span class="line">d14=<span class="number">111100010011010</span></span><br><span class="line">d15=<span class="number">100011110101100</span></span><br></pre></td></tr></table></figure>
<h4 id="算法运行"><a href="#算法运行" class="headerlink" title="算法运行"></a>算法运行</h4><p>初始化阶段：</p>
<ol>
<li>输入初始化密钥KEY和初始向量IV，并进行密钥装入，并将F函数中的R0和R1全部先置为0</li>
<li>依序重复执行32次：比特重组、F函数、LFSR初始化模式（其中的u是F函数输出的32位W去掉最低位得到的）</li>
<li>再执行一次：比特重组、F函数（输出的W不要）、LFSR工作模式</li>
<li>再：比特重组、F函数的W与X3异或得到密钥Z、LFSR工作模式</li>
</ol>
<hr>
<h3 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h3><p>特性：压缩性、易计算、抗修改、碰撞难度大。目前已经不安全<a target="_blank" rel="noopener" href="https://www.cmd5.com/">md5在线解密</a>、<a target="_blank" rel="noopener" href="https://www.somd5.com/">SOMD5</a>。算法参考<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1aP411M7ug/?spm_id_from=333.337.search-card.all.click&amp;vd_source=a14ed599179f7f184401f3073d4efefa">MD5算法详解_哔哩哔哩_bilibili</a></p>
<h4 id="预填充处理"><a href="#预填充处理" class="headerlink" title="预填充处理"></a>预填充处理</h4><ol>
<li>将任意长度的明文进行扩展（后面紧跟一个1，之后以0填充），使其在mod 512之后能够剩余448bit</li>
<li>再在后面添加一个64位的、填充信息前的、明文长度，如果长度超过64位则取低64位</li>
<li>引入链接变量<code>A=0x67452301,B=0xefcdab89,C=0x98badcfe,D=0x10325476</code>（可在程序中写的数，不涉及底层大小端存储，便于理解）</li>
</ol>
<h4 id="分组处理"><a href="#分组处理" class="headerlink" title="分组处理"></a>分组处理</h4><p>将处理后的明文按512bit分组，每组拿上面的128bit的数参与运算，得到128bit的结果，并接着输入。大循环4轮（4种操作），每轮下面又有16次运算（1种操作的16种不同参数）。下面是其中的关键运算函数</p>
<p><strong>4个非线性函数</strong>：被用于4种操作</p>
<ul>
<li>$F(X,Y,Z)=(X\&amp;Y)|((~X)\&amp;Z);$</li>
<li>$G(X,Y,Z)=(X\&amp;Z)|(Y\&amp;(~Z));$</li>
<li>$H(X,Y,Z)=X \wedge Y \wedge Z;$</li>
<li>$I(X,Y,Z)=Y \wedge (X|(~Z));$</li>
</ul>
<p><strong>4种操作</strong>：(&lt;&lt;&lt;循环左移)</p>
<ul>
<li>$FF(a,b,c,d,Mi,s,tj):a=b+((a+F(b,c,d)+M_{i}+t_{j})&lt;&lt;&lt;s)$</li>
<li>$GG(a,b,c,d,Mi,s,tj):a=b+((a+G(b,c,d)+M_{i}+t_{j})&lt;&lt;&lt;s)$</li>
<li>$HH(a,b,c,d,Mi,s,tj):a=b+((a+H(b,c,d)+M_{i}+t_{j}&lt;&lt;&lt;s)$</li>
<li>$II(a,b,c,d,Mi,s,tj):a=b+((a+I(b,c,d)+M_{i}+t_{j})&lt;&lt;&lt;s)$</li>
</ul>
<p>第一组运算时，将a=A,b=B,c=C,d=D进行赋值，在4×16次运算之后，A+=a,B+=b,C+=c,D+=d，并代入到下一组的计算…最后一组计算完成之后，将ABCD进行拼接，得到的16字节即为MD5结果</p>
<p><strong>$t_{j}$</strong>：$t_{j}=2^{32}*abs(sin(j)),j=1,2…64$，也可取如下常量表</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t[<span class="number">64</span>]=&#123;</span><br><span class="line">    <span class="number">0xd76aa478</span>,<span class="number">0xe8c7b756</span>, <span class="number">0x242070db</span>,<span class="number">0xcl</span>bdceee, <span class="number">0xf57c</span>Ofaf, <span class="number">0x4787c62a</span>, 	<span class="number">0xa8304613</span>, <span class="number">0xfd469501</span>,<span class="number">0x698098d8</span>, <span class="number">0x8b44f7af</span>,<span class="number">0xffff5bb1</span>,<span class="number">0x895cd7be</span>, <span class="number">0x6b901122</span>, <span class="number">0xfd987193</span>,<span class="number">0xa679438e</span>, <span class="number">0x49b40821</span>, <span class="number">0xf61e2562</span>, <span class="number">0xc040b340</span>, <span class="number">0x265e5a51</span>, <span class="number">0xe9b6c7aa</span>, <span class="number">0xd62f105d</span>, <span class="number">0x02441453</span>,<span class="number">0xd8a1e681</span>, <span class="number">0x2l</span>elcde6, <span class="number">0xc33707d6</span>, <span class="number">0xf4d50d87</span>, <span class="number">0x455al</span>4ed, <span class="number">0xa9e3e905</span>, <span class="number">0xfcefa3f8</span>, <span class="number">0x676f02d9</span>, <span class="number">0x8d2a4c8a</span>, <span class="number">0xfffa3942</span>, <span class="number">0x8771f681</span>,<span class="number">0x6d9d6122</span>, <span class="number">0xfde5380c</span>, <span class="number">0xa4beea44</span>, <span class="number">0x4bdecfa9</span>,<span class="number">0xf6bb4b60</span>, <span class="number">0xbebfbc70</span>, <span class="number">0x289b7ec6</span>, <span class="number">0xeaal</span>27fa, <span class="number">0xd4ef3085</span>, <span class="number">0x04881d05</span>, <span class="number">0xd9d4d039</span>, <span class="number">0xe6db99e5</span>, <span class="number">0</span>xlfa27cf8, <span class="number">0xc4ac5665</span>, <span class="number">0xf4292244</span>, <span class="number">0x432aff97</span>,<span class="number">0xab9423a7</span>, <span class="number">0xfc93a039</span>, <span class="number">0x655b59c3</span>,<span class="number">0x8f0ccc92</span>, <span class="number">0xffeff47d</span>,<span class="number">0x85845dd1</span>, <span class="number">0x6fa87e4f</span>,<span class="number">0xfe2ce6e0</span>, <span class="number">0xa3014314</span>,<span class="number">0x4e0811a1</span>, <span class="number">0xf7537e82</span>, <span class="number">0xbd3af235</span>,<span class="number">0x2ad7d2bb</span>, <span class="number">0xeb86d391</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>$M_{i}$</strong>：将512bit的分组，按照4字节即32bit，再次分组，共16小组，i代表组，但是取出Mi值时，需要注意按照小端读取。</p>
<p><strong>S</strong>：固定位移表，如下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">S[<span class="number">64</span>]=&#123;</span><br><span class="line">	<span class="number">7</span>,<span class="number">12</span>,<span class="number">17</span>,<span class="number">22</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">17</span>,<span class="number">22</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">17</span>,<span class="number">22</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">17</span>,<span class="number">22</span>,</span><br><span class="line">	<span class="number">5</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">20</span>,</span><br><span class="line">	<span class="number">4</span>,<span class="number">11</span>,<span class="number">16</span>,<span class="number">23</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">16</span>,<span class="number">23</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">16</span>,<span class="number">23</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">16</span>,<span class="number">23</span>,</span><br><span class="line">	<span class="number">6</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">21</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">21</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">21</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">21</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="SM3"><a href="#SM3" class="headerlink" title="SM3"></a>SM3</h3><p>中国商用密码杂凑算法，多用于数字签名和验证，是一种消息摘要算法。基于SHA-256，安全性与其相当。官网参考<a target="_blank" rel="noopener" href="http://c.gb688.cn/bzgk/gb/showGb?type=online&amp;hcno=45B1A67F20F3BF339211C391E9278F5E">GB/T 32905-2016 (gb688.cn)</a></p>
<p>大致过程：消息填充、消息扩展、迭代压缩</p>
<h4 id="消息填充"><a href="#消息填充" class="headerlink" title="消息填充"></a>消息填充</h4><p>以512位数据分组作为输入，填充规则与MD5相同，不多bb</p>
<h4 id="消息扩展"><a href="#消息扩展" class="headerlink" title="消息扩展"></a>消息扩展</h4><p>将16个字（64字节）的输入转换为132（68$W_{i}$+64$W’_{i}$）个字，隐藏了原消息位之间的关联。</p>
<p>步骤如下：</p>
<ol>
<li><p>消息分组再次分为16组（1组1字）：$W_{0}…W_{15}$</p>
</li>
<li><p>$W_{i}=P_{1}(W_{i-16}\oplus W_{i-9}\oplus (W_{i-3}&lt;&lt;&lt;15))\oplus (W_{i-13}&lt;&lt;&lt;7)\oplus W_{i-6}$；其中i=16-67</p>
<p>$P_{1}(X)=X\oplus (X&lt;&lt;&lt;15)\oplus (X&lt;&lt;&lt;23)$</p>
</li>
<li><p>$W’_{i}=W_{i}\oplus W_{i+4}$；其中i=0-63</p>
</li>
</ol>
<h4 id="迭代压缩"><a href="#迭代压缩" class="headerlink" title="迭代压缩"></a>迭代压缩</h4><p>$V^{i+1}=CF(V^{i},B^{i}),i=0…n-1$，其中B为扩展过的消息分组，V0是一个256bit的初始向量，得到的最后的$V^{n}$就是原消息的Hash值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">V0=<span class="number">7380166</span>f <span class="number">4914</span>b2b9 <span class="number">172442</span>d7 da8a0600 a96130bc <span class="number">163138</span>aa e38dee4d b0fb<span class="number">0e4</span>e</span><br></pre></td></tr></table></figure>
<p><strong>CF压缩函数</strong>（core）：</p>
<p>共进行64轮，设置ABCDEFGH，共8个32bit字寄存器，用V0赋值，进入第一轮（SS1、SS2、TT1、TT2为中间变量），具体过程如下：（i为分组号，j为轮数）</p>
<ol>
<li><p>$SS1=((A&lt;&lt;&lt;12)+E+(T_{i}&lt;&lt;&lt;(j\bmod 32)))&lt;&lt;&lt;7$</p>
<blockquote>
<p>j&lt;=15时，Tj=79cc4519，j&gt;=16&amp;&amp;j&lt;=63时，Tj=7a879d8a</p>
</blockquote>
</li>
<li><p>$SS2=SS1\oplus (A&lt;&lt;&lt;12)$</p>
</li>
<li><p>$TT1=FF_{i}(A,B,C)+D+SS2+W’_{i}$</p>
<blockquote>
<p>$FF_{j}(X,Y,Z)\begin{cases}<br>  X\oplus Y\oplus Z;0\le j\le 15\\<br>  (X\wedge Y)\vee (X\wedge Z)\vee (Y\wedge Z);16\le j\le 63<br>\end{cases}$</p>
</blockquote>
</li>
<li><p>$TT2=GG_{i}(E,F,G)+H+SS1+W_{i}$</p>
<blockquote>
<p>$GG_{j}(X,Y,Z)\begin{cases}<br>  X\oplus Y\oplus Z;0\le j\le 15\\<br>  (X\wedge Y)\vee (\neg X\wedge Z);16\le j\le 63<br>\end{cases}$</p>
</blockquote>
</li>
<li><p>$D=C$；（5-12步为，ABCDEFGH的重赋值）</p>
</li>
<li><p>$C=B&lt;&lt;&lt;9$</p>
</li>
<li><p>$B=A$</p>
</li>
<li><p>$A=TT1$</p>
</li>
<li><p>$H=G$</p>
</li>
<li><p>$G=F&lt;&lt;&lt;19$</p>
</li>
<li><p>$F=E$</p>
</li>
<li><p>$E=P_{0}(TT2)$</p>
<blockquote>
<p>$P_{0}(X)=X\oplus (X&lt;&lt;&lt;9)\oplus (X&lt;&lt;&lt;17)$</p>
</blockquote>
</li>
</ol>
<p>在一组经过64轮计算之后，将Vn重新赋值给ABCDEFGH寄存器，得到的就是该分组的Hash</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://zy0t1.github.io">Zy0t1</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://zy0t1.github.io/2023/09/16/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81/">http://zy0t1.github.io/2023/09/16/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://zy0t1.github.io" target="_blank">Zy0t1's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AF%86%E7%A0%81/">密码</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2024/08/08/lJhAQOvR6n5GtjE.webp" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/09/18/Web%E5%AE%89%E5%85%A8/" title="Web安全"><img class="cover" src="https://s2.loli.net/2024/08/08/lJhAQOvR6n5GtjE.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Web安全</div></div></a></div><div class="next-post pull-right"><a href="/2023/09/07/Windows%E4%B8%8D%E5%AE%8C%E5%85%A8%E8%AE%B2%E8%A7%A3/" title="Windows不完全讲解"><img class="cover" src="https://s2.loli.net/2024/08/08/lJhAQOvR6n5GtjE.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Windows不完全讲解</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/web.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zy0t1</div><div class="author-info__description">中二次元晚期</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zy0t1"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zy0t1" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:wy1078041755@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://blog.csdn.net/weixin_62036500" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#DES"><span class="toc-number">1.</span> <span class="toc-text">DES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%8E%E6%96%87%E5%88%9D%E5%A7%8B%E5%8C%96-IP%E7%BD%AE%E6%8D%A2"><span class="toc-number">1.1.</span> <span class="toc-text">明文初始化&#x3D;IP置换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#E%E6%89%A9%E5%B1%95-E%E7%9B%92"><span class="toc-number">1.2.</span> <span class="toc-text">E扩展&#x2F;E盒</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E7%BD%AE%E6%8D%A2"><span class="toc-number">1.3.</span> <span class="toc-text">密钥置换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#S%E7%9B%92%E4%BB%A3%E6%9B%BF"><span class="toc-number">1.4.</span> <span class="toc-text">S盒代替</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#P%E7%9B%92%E6%89%A9%E5%B1%95"><span class="toc-number">1.5.</span> <span class="toc-text">P盒扩展</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IP%E6%9C%AB%E7%BD%AE%E6%8D%A2"><span class="toc-number">1.6.</span> <span class="toc-text">IP末置换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">1.7.</span> <span class="toc-text">补充</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDEA"><span class="toc-number">2.</span> <span class="toc-text">IDEA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E4%BA%A7%E7%94%9F"><span class="toc-number">2.1.</span> <span class="toc-text">密钥产生</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%BD%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text">单轮操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E5%8F%98%E6%8D%A2"><span class="toc-number">2.3.</span> <span class="toc-text">输出变换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES"><span class="toc-number">3.</span> <span class="toc-text">AES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8F%98%E6%8D%A2"><span class="toc-number">3.1.</span> <span class="toc-text">初始变换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E4%BB%A3%E6%8D%A2ByteSub"><span class="toc-number">3.2.</span> <span class="toc-text">字节代换ByteSub</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%8C%E7%A7%BB%E4%BD%8DShiftRows"><span class="toc-number">3.3.</span> <span class="toc-text">行移位ShiftRows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E6%B7%B7%E5%90%88MixColumn"><span class="toc-number">3.4.</span> <span class="toc-text">列混合MixColumn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AE%E5%AF%86%E9%92%A5%E5%8A%A0AddRoundKey"><span class="toc-number">3.5.</span> <span class="toc-text">轮密钥加AddRoundKey</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AE%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90"><span class="toc-number">3.6.</span> <span class="toc-text">轮密钥生成</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TEA%E7%B3%BB%E5%88%97"><span class="toc-number">4.</span> <span class="toc-text">TEA系列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SM4"><span class="toc-number">5.</span> <span class="toc-text">SM4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E8%BF%90%E7%AE%97"><span class="toc-number">5.1.</span> <span class="toc-text">迭代运算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%88%E6%88%90%E7%BD%AE%E6%8D%A2T"><span class="toc-number">5.2.</span> <span class="toc-text">合成置换T</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E6%89%A9%E5%B1%95"><span class="toc-number">5.3.</span> <span class="toc-text">密钥扩展</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85-1"><span class="toc-number">5.4.</span> <span class="toc-text">补充</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RC4"><span class="toc-number">6.</span> <span class="toc-text">RC4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96S%E8%A1%A8"><span class="toc-number">6.1.</span> <span class="toc-text">初始化S表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E6%B5%81%E7%94%9F%E6%88%90"><span class="toc-number">6.2.</span> <span class="toc-text">密钥流生成</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A5%96%E5%86%B2%E4%B9%8BZUC"><span class="toc-number">7.</span> <span class="toc-text">祖冲之ZUC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LFSR"><span class="toc-number">7.1.</span> <span class="toc-text">LFSR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BR"><span class="toc-number">7.2.</span> <span class="toc-text">BR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F%E5%87%BD%E6%95%B0"><span class="toc-number">7.3.</span> <span class="toc-text">F函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E8%A3%85%E5%85%A5"><span class="toc-number">7.4.</span> <span class="toc-text">密钥装入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E8%BF%90%E8%A1%8C"><span class="toc-number">7.5.</span> <span class="toc-text">算法运行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MD5"><span class="toc-number">8.</span> <span class="toc-text">MD5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E5%A1%AB%E5%85%85%E5%A4%84%E7%90%86"><span class="toc-number">8.1.</span> <span class="toc-text">预填充处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%A4%84%E7%90%86"><span class="toc-number">8.2.</span> <span class="toc-text">分组处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SM3"><span class="toc-number">9.</span> <span class="toc-text">SM3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E5%A1%AB%E5%85%85"><span class="toc-number">9.1.</span> <span class="toc-text">消息填充</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E6%89%A9%E5%B1%95"><span class="toc-number">9.2.</span> <span class="toc-text">消息扩展</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E5%8E%8B%E7%BC%A9"><span class="toc-number">9.3.</span> <span class="toc-text">迭代压缩</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Zy0t1</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>